fragment SurveyAppRule on FormLogicRule {
  booleanOperator
  command
  conditions {
    id
    operator
    ruleId
    subjectId
    value
  }
  formElementId
  id
  jumpToId
  position
}

fragment SurveyAppFormElement on FormElement {
  id
  componentSettings
  alternateLanguageSettings
  body
  isRequired
  isInput
  position
  typeId
  formId
  type {
    componentName
    isInput
    isSingleUseOnly
    isSurveysOnly
    label
    isSpatial
    allowedLayouts
    supportedOperators
    isHidden
  }
  sketchClass {
    ...SketchClassDetails
  }
  backgroundColor
  secondaryColor
  backgroundImage
  layout
  textVariant
  unsplashAuthorName
  unsplashAuthorUrl
  backgroundWidth
  backgroundHeight
  jumpToId
  subordinateTo
  mapBasemaps
  mapCameraOptions
}

fragment SurveyAppSurvey on Survey {
  id
  name
  accessType
  isDisabled
  showProgress
  showFacilitationOption
  supportedLanguages
  form {
    id
    logicRules {
      ...SurveyAppRule
    }
    formElements {
      ...SurveyAppFormElement
    }
  }
}

query Survey($id: Int!) {
  me {
    isAdmin
    profile {
      email
      fullname
    }
  }
  currentProject {
    name
    url
    region {
      geojson
    }
  }
  survey(id: $id) {
    ...SurveyAppSurvey
  }
}

mutation CreateResponse(
  $surveyId: Int!
  $isDraft: Boolean!
  $bypassedDuplicateSubmissionControl: Boolean!
  $responseData: JSON!
  $facilitated: Boolean!
  $practice: Boolean!
) {
  createSurveyResponse(
    input: {
      surveyId: $surveyId
      draft: $isDraft
      responseData: $responseData
      bypassedSubmissionControl: $bypassedDuplicateSubmissionControl
      facilitated: $facilitated
      practice: $practice
    }
  ) {
    clientMutationId
    surveyResponse {
      id
    }
  }
}

query GetBasemapsAndRegion {
  currentProject {
    id
    basemaps {
      ...BasemapDetails
    }
    surveyBasemaps {
      ...BasemapDetails
    }
    region {
      geojson
    }
  }
}
