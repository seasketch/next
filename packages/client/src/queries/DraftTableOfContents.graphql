query DraftTableOfContents($slug: String!) {
  projectBySlug(slug: $slug) {
    id
    draftTableOfContentsItems {
      id
      dataLayerId
      title
      acl {
        id
        type
      }
      isClickOffOnly
      isFolder
      stableId
      parentStableId
      showRadioChildren
      bounds
      sortIndex
      hideChildren
      enableDownload
    }
  }
}

query layersAndSourcesForItems(
  $slug: String!
  $tableOfContentsItemIds: [Int]!
) {
  projectBySlug(slug: $slug) {
    id
    dataSourcesForItems(tableOfContentsItemIds: $tableOfContentsItemIds) {
      attribution
      bounds
      bucketId
      buffer
      byteLength
      cluster
      clusterMaxZoom
      clusterProperties
      clusterRadius
      coordinates
      createdAt
      encoding
      enhancedSecurity
      id
      importType
      lineMetrics
      maxzoom
      minzoom
      objectKey
      originalSourceUrl
      queryParameters
      scheme
      tiles
      tileSize
      tolerance
      type
      url
      urls
      useDevicePixelRatio
      supportsDynamicLayers
      interactivitySettings {
        dataSourceId
        id
        cursor
        longTemplate
        shortTemplate
        sourceLayer
        type
      }
    }
    dataLayersForItems(tableOfContentsItemIds: $tableOfContentsItemIds) {
      sprites {
        id
        spriteImages {
          pixelRatio
          height
          width
          url
        }
        type
      }
      zIndex
      dataSourceId
      id
      mapboxGlStyles
      renderUnder
      sourceLayer
      sublayer
    }
  }
}

mutation CreateFolder(
  $title: String!
  $stableId: String!
  $projectId: Int!
  $parentStableId: String
  $isClickOffOnly: Boolean
  $showRadioChildren: Boolean
  $hideChildren: Boolean
) {
  createTableOfContentsItem(
    input: {
      tableOfContentsItem: {
        title: $title
        stableId: $stableId
        projectId: $projectId
        parentStableId: $parentStableId
        isFolder: true
        isClickOffOnly: $isClickOffOnly
        showRadioChildren: $showRadioChildren
        hideChildren: $hideChildren
      }
    }
  ) {
    tableOfContentsItem {
      id
      title
      stableId
      projectId
      parentStableId
      isClickOffOnly
      isDraft
      isFolder
      showRadioChildren
      isClickOffOnly
      sortIndex
      hideChildren
      enableDownload
    }
  }
}

mutation DeleteBranch($id: Int!) {
  deleteTableOfContentsBranch(input: { tableOfContentsItemId: $id }) {
    clientMutationId
  }
}

mutation UpdateTableOfContentsItemChildren($id: Int, $childIds: [Int]!) {
  updateTableOfContentsItemChildren(
    input: { parentId: $id, childIds: $childIds }
  ) {
    tableOfContentsItems {
      id
      sortIndex
      parentStableId
    }
  }
}

query GetFolder($id: Int!) {
  tableOfContentsItem(id: $id) {
    id
    bounds
    isClickOffOnly
    showRadioChildren
    title
    hideChildren
  }
}

mutation UpdateFolder(
  $id: Int!
  $bounds: [BigFloat]
  $isClickOffOnly: Boolean
  $showRadioChildren: Boolean
  $title: String
  $hideChildren: Boolean
) {
  updateTableOfContentsItem(
    input: {
      id: $id
      patch: {
        bounds: $bounds
        isClickOffOnly: $isClickOffOnly
        showRadioChildren: $showRadioChildren
        title: $title
        hideChildren: $hideChildren
      }
    }
  ) {
    tableOfContentsItem {
      id
      bounds
      isClickOffOnly
      showRadioChildren
      hideChildren
      title
    }
  }
}

query GetLayerItem($id: Int!) {
  tableOfContentsItem(id: $id) {
    id
    acl {
      nodeId
      id
      type
      groups {
        id
        name
      }
    }
    bounds
    dataLayerId
    metadata
    parentStableId
    projectId
    stableId
    title
    enableDownload
    dataLayer {
      id
      zIndex
      mapboxGlStyles
      renderUnder
      sourceLayer
      sublayer
      sprites {
        id
        spriteImages {
          pixelRatio
          height
          width
          url
        }
        type
      }
      dataSource {
        id
        attribution
        bounds
        bucketId
        buffer
        byteLength
        cluster
        clusterMaxZoom
        clusterProperties
        clusterRadius
        coordinates
        createdAt
        encoding
        enhancedSecurity
        generateId
        importType
        lineMetrics
        maxzoom
        minzoom
        objectKey
        originalSourceUrl
        promoteId
        queryParameters
        scheme
        tiles
        tileSize
        tolerance
        type
        url
        urls
        useDevicePixelRatio
        supportsDynamicLayers
      }
    }
  }
}

mutation UpdateTableOfContentsItem(
  $id: Int!
  $title: String
  $bounds: [BigFloat]
  $metadata: JSON
) {
  updateTableOfContentsItem(
    input: {
      id: $id
      patch: { title: $title, bounds: $bounds, metadata: $metadata }
    }
  ) {
    tableOfContentsItem {
      id
      bounds
      metadata
      title
    }
  }
}

mutation UpdateEnableDownload($id: Int!, $enableDownload: Boolean) {
  updateTableOfContentsItem(
    input: { id: $id, patch: { enableDownload: $enableDownload } }
  ) {
    tableOfContentsItem {
      id
      enableDownload
    }
  }
}

mutation UpdateLayer(
  $id: Int!
  $renderUnder: RenderUnderType
  $mapboxGlStyles: JSON
  $sublayer: String
) {
  updateDataLayer(
    input: {
      id: $id
      patch: {
        renderUnder: $renderUnder
        mapboxGlStyles: $mapboxGlStyles
        sublayer: $sublayer
      }
    }
  ) {
    dataLayer {
      id
      zIndex
      renderUnder
      mapboxGlStyles
      sublayer
      sprites {
        id
        spriteImages {
          pixelRatio
          height
          width
          url
        }
        type
      }
    }
  }
}

mutation UpdateDataSource($id: Int!, $attribution: String) {
  updateDataSource(input: { id: $id, patch: { attribution: $attribution } }) {
    dataSource {
      id
      attribution
      bounds
      bucketId
      buffer
      byteLength
      cluster
      clusterMaxZoom
      clusterProperties
      clusterRadius
      coordinates
      createdAt
      encoding
      enhancedSecurity
      generateId
      importType
      lineMetrics
      maxzoom
      minzoom
      objectKey
      originalSourceUrl
      promoteId
      queryParameters
      scheme
      tiles
      tileSize
      tolerance
      type
      url
      urls
      useDevicePixelRatio
      supportsDynamicLayers
    }
  }
}

query InteractivitySettingsForSource($sourceId: Int!) {
  dataSource(id: $sourceId) {
    id
    interactivitySettings {
      cursor
      dataSourceId
      id
      longTemplate
      shortTemplate
      sourceLayer
      type
    }
  }
}

mutation UpdateInteractivitySettings(
  $id: Int!
  $type: InteractivityType
  $cursor: CursorType
  $longTemplate: String
  $shortTemplate: String
) {
  updateInteractivitySetting(
    input: {
      id: $id
      patch: {
        type: $type
        cursor: $cursor
        longTemplate: $longTemplate
        shortTemplate: $shortTemplate
      }
    }
  ) {
    interactivitySetting {
      id
      type
      cursor
      dataSourceId
      longTemplate
      shortTemplate
      sourceLayer
    }
  }
}

query DataSourceUrlProperties($id: Int!) {
  dataSource(id: $id) {
    id
    type
    bucketId
    objectKey
    url
    originalSourceUrl
  }
}

mutation UpdateZIndexes($dataLayerIds: [Int]!) {
  updateZIndexes(input: { dataLayerIds: $dataLayerIds }) {
    dataLayers {
      id
      zIndex
    }
  }
}

mutation UpdateRenderUnderType($layerId: Int!, $renderUnder: RenderUnderType) {
  updateDataLayer(
    input: { id: $layerId, patch: { renderUnder: $renderUnder } }
  ) {
    dataLayer {
      id
      renderUnder
    }
  }
}
