fragment SketchTocDetails on Sketch {
  id
  bbox
  name
  numVertices
  sketchClassId
  collectionId
  bbox
  folderId
  sketchClass {
    geometryType
  }
}

fragment SketchFolderDetails on SketchFolder {
  collectionId
  folderId
  id
  name
}

query Sketching($slug: String!) {
  projectBySlug(slug: $slug) {
    id
    sketchClasses {
      ...SketchingDetails
    }
    mySketches {
      ...SketchTocDetails
    }
    myFolders {
      ...SketchFolderDetails
    }
  }
}

mutation CreateSketchFolder(
  $slug: String!
  $name: String!
  $folderId: Int
  $collectionId: Int
) {
  createSketchFolder(
    input: {
      slug: $slug
      name: $name
      folderId: $folderId
      collectionId: $collectionId
    }
  ) {
    sketchFolder {
      ...SketchFolderDetails
    }
  }
}

mutation CreateSketch(
  $name: String!
  $sketchClassId: Int!
  $userGeom: GeoJSON!
  $collectionId: Int
  $folderId: Int
) {
  createSketch(
    name: $name
    sketchClassId: $sketchClassId
    userGeom: $userGeom
    folderId: $folderId
    collectionId: $collectionId
  ) {
    ...SketchTocDetails
  }
}

mutation UpdateSketch(
  $id: Int!
  $name: String!
  $userGeom: GeoJSON!
  $properties: JSON
) {
  updateSketch(
    input: {
      id: $id
      patch: { name: $name, userGeom: $userGeom, properties: $properties }
    }
  ) {
    sketch {
      ...SketchTocDetails
      id
      name
      userGeom {
        geojson
      }
      properties
    }
  }
}

mutation DeleteSketch($id: Int!) {
  deleteSketch(input: { id: $id }) {
    sketch {
      id
    }
  }
}

mutation DeleteSketchFolder($id: Int!) {
  deleteSketchFolder(input: { id: $id }) {
    sketchFolder {
      id
    }
  }
}

mutation RenameFolder($id: Int!, $name: String!) {
  updateSketchFolder(input: { id: $id, patch: { name: $name } }) {
    sketchFolder {
      id
      name
    }
  }
}

fragment SketchEditorModalDetails on Sketch {
  ...SketchTocDetails
  userGeom {
    geojson
  }
  properties
  sketchClass {
    ...SketchingDetails
    form {
      id
      formElements {
        id
        type {
          componentName
        }
      }
    }
  }
}

query GetSketchForEditing($id: Int!) {
  sketch(id: $id) {
    ...SketchEditorModalDetails
  }
}

mutation UpdateSketchFolderParent($id: Int!, $parentId: Int) {
  updateSketchFolder(input: { id: $id, patch: { folderId: $parentId } }) {
    sketchFolder {
      id
      folderId
    }
  }
}
