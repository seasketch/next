fragment SurveyListDetails on Survey {
  id
  accessType
  showProgress
  invitedGroups {
    id
    name
  }
  isDisabled
  limitToSingleResponse
  name
  submittedResponseCount
  practiceResponseCount
  projectId
  isTemplate
  showFacilitationOption
}

query Surveys($projectId: Int!) {
  project(id: $projectId) {
    id
    surveys {
      ...SurveyListDetails
    }
  }
}

mutation CreateSurvey($name: String!, $projectId: Int!, $templateId: Int) {
  makeSurvey(
    input: { projectId: $projectId, name: $name, templateId: $templateId }
  ) {
    survey {
      ...SurveyListDetails
    }
  }
}

query SurveyById($id: Int!) {
  survey(id: $id) {
    ...SurveyListDetails
  }
}

fragment FormElementFullDetails on FormElement {
  body
  componentSettings
  exportId
  formId
  id
  isRequired
  position
  jumpToId
  type {
    componentName
    isHidden
    isInput
    isSingleUseOnly
    isSurveysOnly
    label
    supportedOperators
  }
  typeId
  backgroundColor
  secondaryColor
  backgroundImage
  backgroundImagePlacement
  backgroundPalette
  textVariant
  unsplashAuthorUrl
  unsplashAuthorName
  backgroundWidth
  backgroundHeight
}

query SurveyFormEditorDetails($id: Int!, $slug: String!) {
  projectBySlug(slug: $slug) {
    name
  }
  formElementTypes {
    componentName
    isHidden
    isInput
    isSingleUseOnly
    isSurveysOnly
    label
    supportedOperators
  }
  survey(id: $id) {
    ...SurveyListDetails
    form {
      id
      isTemplate
      surveyId
      templateName
      templateType
      formElements {
        ...FormElementFullDetails
      }
      logicRules {
        booleanOperator
        command
        id
        jumpToId
        position
        formElementId
        conditions {
          id
          operator
          value
          subjectId
          ruleId
        }
      }
    }
  }
  currentProject {
    name
    url
  }
}

mutation UpdateSurveyBaseSettings(
  $id: Int!
  $showProgress: Boolean
  $showFacilitationOption: Boolean
) {
  updateSurvey(
    input: {
      id: $id
      patch: {
        showProgress: $showProgress
        showFacilitationOption: $showFacilitationOption
      }
    }
  ) {
    survey {
      id
      showProgress
      showFacilitationOption
    }
  }
}

mutation UpdateFormElement(
  $id: Int!
  $isRequired: Boolean
  $body: JSON
  $exportId: String
  $componentSettings: JSON
  $jumpToId: Int
  $typeId: String
) {
  updateFormElement(
    input: {
      id: $id
      patch: {
        isRequired: $isRequired
        body: $body
        exportId: $exportId
        componentSettings: $componentSettings
        jumpToId: $jumpToId
        typeId: $typeId
      }
    }
  ) {
    formElement {
      id
      isRequired
      body
      exportId
      componentSettings
      jumpToId
      typeId
    }
  }
}

mutation UpdateComponentSettings($id: Int!, $componentSettings: JSON) {
  updateFormElement(
    input: { id: $id, patch: { componentSettings: $componentSettings } }
  ) {
    formElement {
      id
      componentSettings
    }
  }
}

mutation UpdateFormElementBody($id: Int!, $body: JSON!) {
  updateFormElement(input: { id: $id, patch: { body: $body } }) {
    formElement {
      id
      body
    }
  }
}

mutation UpdateFormElementOrder($elementIds: [Int]) {
  setFormElementOrder(input: { elementIds: $elementIds }) {
    formElements {
      id
      position
    }
  }
}

mutation AddFormElement(
  $body: JSON!
  $componentSettings: JSON!
  $formId: Int!
  $componentType: String!
  $position: Int
  $exportId: String
) {
  createFormElement(
    input: {
      formElement: {
        body: $body
        componentSettings: $componentSettings
        formId: $formId
        isRequired: false
        typeId: $componentType
        position: $position
        exportId: $exportId
      }
    }
  ) {
    formElement {
      ...FormElementFullDetails
    }
  }
}

mutation DeleteFormElement($id: Int!) {
  deleteFormElement(input: { id: $id }) {
    formElement {
      id
    }
  }
}

mutation UpdateForm($id: Int!, $isTemplate: Boolean, $templateName: String) {
  updateForm(
    input: {
      id: $id
      patch: { isTemplate: $isTemplate, templateName: $templateName }
    }
  ) {
    form {
      id
      isTemplate
      templateName
    }
  }
}

query GetPhotos($query: String!) {
  getUnsplashPhotos(query: $query) {
    results {
      blur_hash
      color
      description
      height
      width
      id
      links {
        download_location
      }
      urls {
        full
        raw
        regular
        small
        thumb
      }
      user {
        id
        name
        username
        links {
          html
        }
      }
    }
  }
}

mutation UpdateFormElementBackground(
  $id: Int!
  $backgroundColor: String
  $secondaryColor: String
  $backgroundPalette: [String]
  $textVariant: FormElementTextVariant
  $backgroundImagePlacement: FormElementBackgroundImagePlacement
) {
  updateFormElement(
    input: {
      id: $id
      patch: {
        backgroundColor: $backgroundColor
        secondaryColor: $secondaryColor
        backgroundPalette: $backgroundPalette
        textVariant: $textVariant
        backgroundImagePlacement: $backgroundImagePlacement
      }
    }
  ) {
    formElement {
      id
      backgroundColor
      secondaryColor
      backgroundImage
      backgroundImagePlacement
      backgroundPalette
      textVariant
      unsplashAuthorName
      unsplashAuthorUrl
    }
  }
}

mutation SetFormElementBackground(
  $id: Int!
  $backgroundColor: String!
  $secondaryColor: String!
  $backgroundUrl: String!
  $downloadUrl: String!
  $backgroundPalette: [String]!
  $unsplashAuthorUrl: String!
  $unsplashAuthorName: String!
  $backgroundWidth: Int!
  $backgroundHeight: Int!
) {
  setFormElementBackground(
    backgroundColor: $backgroundColor
    secondaryColor: $secondaryColor
    backgroundPalette: $backgroundPalette
    backgroundUrl: $backgroundUrl
    downloadUrl: $downloadUrl
    id: $id
    unsplashAuthorName: $unsplashAuthorName
    unsplashAuthorUrl: $unsplashAuthorUrl
    backgroundHeight: $backgroundHeight
    backgroundWidth: $backgroundWidth
  ) {
    id
    backgroundColor
    secondaryColor
    backgroundImage
    backgroundPalette
    unsplashAuthorName
    unsplashAuthorUrl
    backgroundWidth
    backgroundHeight
  }
}

mutation clearFormElementStyle($id: Int!) {
  clearFormElementStyle(input: { formElementId: $id }) {
    formElement {
      id
      backgroundColor
      backgroundImage
      backgroundPalette
      unsplashAuthorName
      unsplashAuthorUrl
      textVariant
      secondaryColor
    }
  }
}

mutation createLogicRuleForSurvey(
  $formElementId: Int!
  $operator: FieldRuleOperator!
  $jumpToId: Int!
) {
  createSurveyJumpRule(
    input: {
      formElementId: $formElementId
      booleanOperator: OR
      jumpToId: $jumpToId
      operator: $operator
    }
  ) {
    formLogicRule {
      id
      position
      booleanOperator
      command
      formElementId
      jumpToId
      conditions {
        id
        operator
        ruleId
        subjectId
        value
      }
    }
  }
}

mutation UpdateFormLogicRule(
  $id: Int!
  $jumpToId: Int
  $booleanOperator: FormLogicOperator
  $formElementId: Int
) {
  updateFormLogicRule(
    input: {
      id: $id
      patch: {
        jumpToId: $jumpToId
        booleanOperator: $booleanOperator
        formElementId: $formElementId
      }
    }
  ) {
    formLogicRule {
      id
      booleanOperator
      command
      jumpToId
      position
    }
  }
}

mutation UpdateLogicCondition(
  $id: Int!
  $operator: FieldRuleOperator
  $value: JSON
) {
  updateFormLogicCondition(
    input: { id: $id, patch: { operator: $operator, value: $value } }
  ) {
    formLogicCondition {
      id
      ruleId
      operator
      subjectId
      value
    }
  }
}

mutation DeleteLogicCondition($id: Int!) {
  deleteFormLogicCondition(input: { id: $id }) {
    formLogicCondition {
      id
      ruleId
    }
  }
}

mutation DeleteLogicRule($id: Int!) {
  deleteFormLogicRule(input: { id: $id }) {
    formLogicRule {
      id
      formElementId
    }
  }
}

mutation AddCondition(
  $operator: FieldRuleOperator!
  $ruleId: Int!
  $subjectId: Int!
  $value: JSON
) {
  createFormLogicCondition(
    input: {
      formLogicCondition: {
        operator: $operator
        ruleId: $ruleId
        subjectId: $subjectId
        value: $value
      }
    }
  ) {
    formLogicCondition {
      id
      operator
      ruleId
      subjectId
      value
    }
  }
}
